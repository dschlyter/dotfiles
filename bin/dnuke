#!/bin/bash

# no set -e because we want commands to always run

RUNNING="$(docker ps | awk '{print $1}' | tail -n +2)"
for CONTAINER in $RUNNING; do
    docker kill "$CONTAINER"
done

docker rm -v $(docker ps --filter status=exited -q 2>/dev/null) 2>/dev/null
docker rmi $(docker images --filter dangling=true -q 2>/dev/null) 2>/dev/null
docker volume prune -f
