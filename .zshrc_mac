# display power management log for current day (mostly interesting for display lock / unlock times)
alias pmlog='open $(echo /var/log/powermanagement/2* | xargs -n 1 echo | tail -n 1)'
alias ij='open -a "IntelliJ IDEA" .'
alias rau='reattach-to-user-namespace'

# default alias makes OSX outdated binaries sad :(
alias ls='ls -h -G'
alias o='open'

# flag is not supported or needed on OS X
alias -g MAP='| xargs -n 1'
alias -g MAPI='| xargs -n 1 -i'

# set iterm title to current dir
# credit to https://gist.github.com/phette23/5270658
precmd() {
    echo -ne "\e]1;${PWD##*/}\a"
}

# use updated coreutils and findutils by default
function use_gnu() {
    type "g$1" > /dev/null && alias $1="g$1$2"
}

use_gnu ls " -h --color=auto --group-directories-first"
use_gnu wc
use_gnu sed
use_gnu sort
use_gnu tac
use_gnu cp
use_gnu ln
use_gnu du
use_gnu stat
use_gnu xargs

function handlemail() {
    cat /var/mail/$USER
    sudo rm /var/mail/$USER
}

# mutli-user brew can be a bit buggy, a hack to work around it
alias claimbrew="sudo chmod -R g+w /usr/local"
alias claimbrew2="sudo chown -R brew /usr/local"

# brew convinience function
local BREW_UPDATE_FILE=/usr/local/.brew_lastupdate
alias bup="brew update && brew upgrade && date +%s > $BREW_UPDATE_FILE"

local NOW="$(date +%s)"
local LAST_UPDATE="0$(cat $BREW_UPDATE_FILE)"
local DIFF_DAYS=$((($NOW - $LAST_UPDATE) / (3600 * 24)))
if [ $DIFF_DAYS -gt 7 ]; then
    echo "Homebrew has not been upgraded in $DIFF_DAYS days. Run upgrade with 'bup'"
fi
